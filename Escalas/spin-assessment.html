<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventario de Fobia Social (SPIN)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #29A98C 0%, #112F33 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 900px;
            overflow: hidden;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header {
            background: linear-gradient(135deg, #29A98C 0%, #112F33 100%);
            color: #FFF8EE;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .progress-container {
            background: rgba(255,248,238,0.2);
            border-radius: 10px;
            height: 8px;
            margin-top: 20px;
            overflow: hidden;
        }

        .progress-bar {
            background: #FFF8EE;
            height: 100%;
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        .content {
            padding: 40px;
        }

        .question-container {
            text-align: center;
            margin-bottom: 30px;
        }

        .question-intro {
            font-size: 1.1rem;
            color: #666;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .question-number {
            font-size: 0.9rem;
            font-weight: 500;
            color: #29A98C;
            margin-bottom: 25px;
            opacity: 0.8;
        }

        .question-text {
            font-size: 1.3rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 30px;
            line-height: 1.4;
        }

        .options {
            display: grid;
            gap: 12px;
            margin-bottom: 30px;
            text-align: left;
        }

        .option-button {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 22px 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1rem;
            font-weight: 500;
            text-align: left;
            position: relative;
            overflow: hidden;
            line-height: 1.5;
        }

        .option-button:hover {
            border-color: #29A98C;
            background: #f0fff8;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(41, 169, 140, 0.2);
        }

        .option-button.selected {
            background: #29A98C;
            color: #FFF8EE;
            border-color: #29A98C;
        }

        .score-display {
            background: linear-gradient(135deg, #29A98C 0%, #112F33 100%);
            color: #FFF8EE;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
        }

        .score-number {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .score-interpretation {
            font-size: 1.3rem;
            opacity: 0.9;
        }

        .subscales-section {
            background: #f0fff8;
            border: 2px solid #29A98C;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .subscales-title {
            color: #112F33;
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
        }

        .subscale-item {
            background: white;
            border: 1px solid #29A98C;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .subscale-info {
            flex: 1;
        }

        .subscale-name {
            font-weight: bold;
            color: #112F33;
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .subscale-description {
            color: #666;
            font-size: 0.9rem;
        }

        .subscale-score {
            background: #29A98C;
            color: #FFF8EE;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 1.1rem;
            font-weight: bold;
            text-align: center;
            min-width: 80px;
        }

        .red-flags-section {
            background: #fff5f5;
            border: 2px solid #EC7367;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            text-align: left;
        }

        .red-flags-title {
            color: #EC7367;
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .red-flag-item {
            background: white;
            border: 1px solid #EC7367;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
        }

        .red-flag-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 15px;
        }

        .red-flag-text {
            flex: 1;
            color: #2d3748;
            line-height: 1.5;
        }

        .red-flag-score {
            background: #FFF8EE;
            color: #EC7367;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            white-space: nowrap;
            border: 1px solid #EC7367;
        }

        .no-red-flags {
            background: #f0fff8;
            border: 2px solid #29A98C;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            text-align: center;
            color: #112F33;
        }

        .button {
            background: linear-gradient(135deg, #29A98C 0%, #112F33 100%);
            color: #FFF8EE;
            border: none;
            border-radius: 12px;
            padding: 15px 30px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(41, 169, 140, 0.3);
        }

        .patient-view-message {
            text-align: center;
            padding: 40px;
        }

        .checkmark {
            width: 80px;
            height: 80px;
            background: #29A98C;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 2rem;
            color: #FFF8EE;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
            }
            
            .content {
                padding: 20px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 1.5rem;
            }
            
            .option-button {
                padding: 15px;
                font-size: 0.95rem;
            }

            .subscale-item {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 id="headerTitle">Inventario de Fobia Social (SPIN)</h1>
            <p id="headerSubtitle">Evaluación de ansiedad social</p>
            <div class="progress-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>
        </div>
        
        <div class="content" id="mainContent">
            <!-- El contenido se generará dinámicamente -->
        </div>
    </div>

    <script>
        class SPINAssessment {
            constructor() {
                this.currentQuestion = 0;
                this.responses = {};
                this.showResults = false;
                this.showDoctorView = false;
                
                this.questions = [
                    "Tengo miedo a las personas con autoridad",
                    "Me molesta ruborizarme delante de la gente",
                    "Las fiestas y acontecimientos sociales me dan miedo",
                    "Evito hablar con desconocidos",
                    "Me da mucho miedo ser criticado",
                    "Por temor al ridículo evito hacer cosas o hablar con la gente",
                    "Sudar en público me produce malestar",
                    "Evito ir a fiestas",
                    "Evito actividades en las que soy el centro de atención",
                    "Hablar con extraños me atemoriza",
                    "Evito dar discursos",
                    "Haría cualquier cosa para evitar ser criticado",
                    "Me dan miedo las palpitaciones cuando estoy con gente",
                    "Temo hacer las cosas cuando la gente puede estar mirándome",
                    "Entre mis mayores miedos están hacer el ridículo o parecer estúpido",
                    "Evito hablar con cualquiera que tenga autoridad",
                    "Temblar o presentar sacudidadas delante de otros me produce malestar"
                ];
                
                this.options = [
                    { value: 0, label: "Nada" },
                    { value: 1, label: "Un poco" },
                    { value: 2, label: "Algo" },
                    { value: 3, label: "Mucho" },
                    { value: 4, label: "Extremo" }
                ];

                // Clasificación por subescalas según literatura científica
                this.fearItems = [0, 2, 4, 9, 13, 14]; // Ítems 1,3,5,10,14,15
                this.avoidanceItems = [3, 5, 7, 8, 10, 11, 15]; // Ítems 4,6,8,9,11,12,16
                this.physiologicalItems = [1, 6, 12, 16]; // Ítems 2,7,13,17
                
                this.init();
            }
            
            init() {
                this.updateProgress();
                this.renderCurrentState();
            }
            
            updateProgress() {
                const progress = ((this.currentQuestion + 1) / this.questions.length) * 100;
                document.getElementById('progressBar').style.width = progress + '%';
            }
            
            renderCurrentState() {
                if (!this.showResults) {
                    this.renderQuestion();
                } else if (!this.showDoctorView) {
                    this.renderPatientResults();
                } else {
                    this.renderDoctorResults();
                }
            }
            
            renderQuestion() {
                const content = document.getElementById('mainContent');
                
                content.innerHTML = `
                    <div class="question-container">
                        <p class="question-intro">
                            ¿Cuánto le han molestado los siguientes problemas durante las últimas semanas?
                        </p>
                        <div class="question-number">
                            ${this.currentQuestion + 1}
                        </div>
                        <div class="question-text">
                            ${this.questions[this.currentQuestion]}
                        </div>
                    </div>
                    
                    <div class="options">
                        ${this.options.map(option => `
                            <button class="option-button" onclick="assessment.handleResponse(${option.value})">
                                ${option.label}
                            </button>
                        `).join('')}
                    </div>
                `;
                
                document.getElementById('headerSubtitle').textContent = 
                    `Pregunta ${this.currentQuestion + 1} de ${this.questions.length}`;
            }
            
            renderPatientResults() {
                document.getElementById('headerTitle').textContent = 'Cuestionario Completado';
                document.getElementById('headerSubtitle').textContent = 'Gracias por completar el SPIN';
                
                const content = document.getElementById('mainContent');
                content.innerHTML = `
                    <div class="patient-view-message">
                        <div class="checkmark">✓</div>
                        <h2 style="font-size: 1.5rem; margin-bottom: 15px; color: #2d3748;">
                            Por favor, pase el dispositivo al médico para su revisión
                        </h2>
                        <p style="color: #666; margin-bottom: 30px; font-size: 1.1rem;">
                            Su información ha sido registrada correctamente
                        </p>
                        <button class="button" onclick="assessment.showDoctorResults()">
                            🩺 Revisar Resultados (Médico)
                        </button>
                    </div>
                `;
            }
            
            renderDoctorResults() {
                document.getElementById('headerTitle').textContent = 'Resultados SPIN - Vista Médica';
                document.getElementById('headerSubtitle').textContent = 'Análisis profesional de ansiedad social';
                
                const totalScore = this.calculateTotal();
                const fearScore = this.calculateFearScore();
                const avoidanceScore = this.calculateAvoidanceScore();
                const physiologicalScore = this.calculatePhysiologicalScore();
                const interpretation = this.getInterpretation(totalScore);
                const redFlags = this.getRedFlags();
                
                const content = document.getElementById('mainContent');
                content.innerHTML = `
                    <div class="score-display">
                        <div class="score-number">${totalScore}/68</div>
                        <div class="score-interpretation">${interpretation}</div>
                    </div>
                    
                    <div class="subscales-section">
                        <h3 class="subscales-title">📊 Análisis por Subescalas</h3>
                        
                        <div class="subscale-item">
                            <div class="subscale-info">
                                <div class="subscale-name">Miedo Social</div>
                                <div class="subscale-description">Temores específicos en situaciones sociales</div>
                            </div>
                            <div class="subscale-score">${fearScore}/24</div>
                        </div>
                        
                        <div class="subscale-item">
                            <div class="subscale-info">
                                <div class="subscale-name">Evitación</div>
                                <div class="subscale-description">Conductas de evitación de situaciones sociales</div>
                            </div>
                            <div class="subscale-score">${avoidanceScore}/28</div>
                        </div>
                        
                        <div class="subscale-item">
                            <div class="subscale-info">
                                <div class="subscale-name">Síntomas Fisiológicos</div>
                                <div class="subscale-description">Manifestaciones físicas de ansiedad social</div>
                            </div>
                            <div class="subscale-score">${physiologicalScore}/16</div>
                        </div>
                    </div>
                    
                    ${redFlags.length > 0 ? `
                        <div class="red-flags-section">
                            <h3 class="red-flags-title">
                                🚩 Síntomas Significativos (Puntuación ≥ 3)
                            </h3>
                            ${redFlags.map(item => `
                                <div class="red-flag-item">
                                    <div class="red-flag-header">
                                        <div class="red-flag-text">
                                            <strong>${item.category}:</strong><br>
                                            ${item.text}
                                        </div>
                                        <div class="red-flag-score">
                                            ${this.getScoreLabel(item.score)}
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    ` : `
                        <div class="no-red-flags">
                            <p><strong>✅ No hay síntomas reportados como significativos (puntuación ≥ 3)</strong></p>
                        </div>
                    `}
                    
                    <div style="text-align: center;">
                        <button class="button" onclick="assessment.resetTest()">
                            🔄 Nuevo Cuestionario
                        </button>
                    </div>
                `;
            }
            
            handleResponse(value) {
                this.responses[this.currentQuestion] = value;
                
                const buttons = document.querySelectorAll('.option-button');
                buttons.forEach((btn, index) => {
                    if (index === value) {
                        btn.classList.add('selected');
                    }
                });
                
                setTimeout(() => {
                    if (this.currentQuestion < this.questions.length - 1) {
                        this.currentQuestion++;
                        this.updateProgress();
                        this.renderCurrentState();
                    } else {
                        this.showResults = true;
                        this.renderCurrentState();
                    }
                }, 800);
            }
            
            showDoctorResults() {
                this.showDoctorView = true;
                this.renderCurrentState();
            }
            
            resetTest() {
                this.currentQuestion = 0;
                this.responses = {};
                this.showResults = false;
                this.showDoctorView = false;
                
                document.getElementById('headerTitle').textContent = 'Inventario de Fobia Social (SPIN)';
                document.getElementById('headerSubtitle').textContent = 'Evaluación de ansiedad social';
                
                this.init();
            }
            
            calculateTotal() {
                return Object.values(this.responses).reduce((sum, value) => sum + value, 0);
            }
            
            calculateFearScore() {
                return this.fearItems.reduce((sum, itemIndex) => {
                    return sum + (this.responses[itemIndex] || 0);
                }, 0);
            }
            
            calculateAvoidanceScore() {
                return this.avoidanceItems.reduce((sum, itemIndex) => {
                    return sum + (this.responses[itemIndex] || 0);
                }, 0);
            }
            
            calculatePhysiologicalScore() {
                return this.physiologicalItems.reduce((sum, itemIndex) => {
                    return sum + (this.responses[itemIndex] || 0);
                }, 0);
            }
            
            getInterpretation(score) {
                if (score >= 0 && score <= 20) return "Sin ansiedad social";
                if (score >= 21 && score <= 30) return "Ansiedad social leve";
                if (score >= 31 && score <= 40) return "Ansiedad social moderada";
                if (score >= 41 && score <= 50) return "Ansiedad social grave";
                if (score >= 51) return "Ansiedad social muy grave";
                return "";
            }
            
            getRedFlags() {
                const redFlags = [];
                
                Object.keys(this.responses).forEach(questionIndex => {
                    const score = this.responses[questionIndex];
                    if (score >= 3) {
                        const questionNum = parseInt(questionIndex);
                        let category = "";
                        
                        if (this.fearItems.includes(questionNum)) {
                            category = "Miedo Social";
                        } else if (this.avoidanceItems.includes(questionNum)) {
                            category = "Evitación";
                        } else if (this.physiologicalItems.includes(questionNum)) {
                            category = "Síntomas Fisiológicos";
                        }
                        
                        redFlags.push({
                            text: this.questions[questionNum],
                            score: score,
                            category: category
                        });
                    }
                });
                
                return redFlags.sort((a, b) => b.score - a.score);
            }
            
            getScoreLabel(score) {
                const labels = ["Nada", "Un poco", "Algo", "Mucho", "Extremo"];
                return labels[score] || "";
            }
        }
        
        const assessment = new SPINAssessment();
    </script>
</body>
</html>